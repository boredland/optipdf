#Um Scan-Tailor nicht zu benutzen habe ich folgenden Vorschlag.

#Step 1 | Vorbereitung | Convertiert mit Ghostscript zu hochauflösenden PGM
mkdir foo1 foo2 foo3
cp foo.pdf foo1/foo.pdf
cd foo1
pdftk foo.pdf burst
rm foo.pdf
##old##/usr/local/bin/parallel -v convert {} -depth 8 -quality 100 -density 270 ../foo2/{.}.pgm -- *.pdf
/usr/local/bin/parallel -v gs -sDEVICE=pgmraw -dNOPAUSE -dBATCH -r270 -sOutputFile=../foo2/{.}.pgm {} -- *.pdf
cd ..

#Step 2 | Seiten teilen, drehen, schwarze Ränder entfernen | Nutzt das Programm "unpaper" (http://unpaper.berlios.de/)
##In der Webanwendung sollte man den Benutzer die Variable "--layout" setzen lassen. "double" für doppelseitigen Input, "single" für einseitigen
rm -r foo1
cd foo2
/usr/local/bin/parallel -v unpaper --layout double -op 2 {} ../foo3/{.}-%02d.pgm -- *.pgm
cd ..
rm -r foo2

#Step 4 | Komprimieren (verlustfrei)
cd foo3
/usr/local/bin/parallel -v jbig2 -s -S -p -v -O {.}.png {} -- *.pgm
rm *.pgm output*

#Step 5 | Text in png erkennen
###a mit tesseract
###/usr/local/bin/parallel -v tesseract {} {.} -l deu hocr -- *.png
###b mit cuneiform
###/usr/local/bin/parallel -v cuneiform -l ger -f hocr -o {.}.hocr {} -- *.png
#pdfocr - tesseract


--- muell ---

###Step (alt )5 | und in einzelne Pdfs zusammenführen
##/usr/local/bin/parallel -v hocrbash {} {.} -- *.png

{##Step 5.1 | #hocrbash | Inhalt der hocrbash
#!/bin/bash
echo $1 $2
hocr2pdf -i "$1" -o "$2".pdf -r 270 < "$2".hocr}

rm -r *files *.png *.hocr

##Step 6 | Zusammenfügen
pdftk *.pdf output ../foo_opti.pdf
cd ..
##Step 7 | Datenmüll entfernen
rm -r foo3
